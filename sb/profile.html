<!DOCTYPE html>
<html lang="en">
<head>
    <title>Profiles</title>

    <!-- Stylesheet -->
    <link rel="stylesheet" href="../js/styles.css"/>
</head>
<body data-sidebar="sb">
<nav>
    <button class="mobile-sidebar-btn" id="mobileSidebarBtn">â˜°</button>
    <div class="breadcrumbs">
        <a href="../home.html">Home</a>
        <span class="separator">/</span>
        <a href="#">Springboot</a>
        <span class="separator">/</span>
        <a href="#">Profiles</a>
    </div>
</nav>
<!-- Components will be inserted here by components.js -->

<!-- Main Content Section -->
<main id="content">
    <h2>1. What Are Profiles?</h2>
    <p>Profiles are one of Spring's most powerful features for managing environment-specific configurations. This
        comprehensive guide covers everything from basic setup to advanced usage patterns.</p>
    <p>Spring Profiles provide a robust way to manage environment-specific configurations while keeping your codebase
        clean and maintainable. By following these patterns, you can build applications that easily adapt to different
        deployment environments.</p>
    <p>Profiles provide a way to segment your application configuration and make it available only in certain
        environments. They allow you to:</p>
    <ul>
        <li>Define environment-specific beans</li>
        <li>Load different property files</li>
        <li>Activate particular features</li>
        <li>Switch between implementations</li>
    </ul>
    <hr>
    <h2>2. Basic Profile Setup</h2>
    <h4>Declaring Profile-Specific Beans</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@Configuration</span>
<span class="annotation">@Profile</span>(<span class="string">"dev"</span>)
<span class="keyword">public class</span> <span class="class">DevConfig</span> {
    <span class="annotation">@Bean</span>
    <span class="keyword">public</span> <span class="class">DataSource</span> <span
          class="method">devDataSource</span>() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span
          class="class">EmbeddedDatabaseBuilder</span>()
            .setType(EmbeddedDatabaseType.H2)
            .build();
    }
}

<span class="annotation">@Configuration</span>
<span class="annotation">@Profile</span>(<span class="string">"prod"</span>)
<span class="keyword">public class</span> <span class="class">ProdConfig</span> {
    <span class="annotation">@Bean</span>
    <span class="keyword">public</span> <span class="class">DataSource</span> <span
          class="method">prodDataSource</span>() {
        <span class="keyword">return</span> <span class="class">DataSourceBuilder</span>.create()
            .url(<span class="string">"jdbc:mysql://prod-db:3306/app"</span>)
            .username(<span class="string">"admin"</span>)
            .password(<span class="string">"secret"</span>)
            .build();
    }
}
  </code>
</pre>

    <h4>Activating Profiles</h4>
    <p>Activate profiles in several ways:</p>
    <ol>
        <li>application.properties:
            <pre class="code-block">
  <code>
<span class="key">spring.profiles.active</span>=<span class="value">dev,debug</span>
  </code>
</pre>
        </li>
        <li>Environment variable:
            <pre class="code-block">
  <code>
<span class="key">export SPRING_PROFILES_ACTIVE</span>=<span class="value">prod</span>
  </code>
</pre>
        </li>
        <li>Command line:
            <pre class="code-block">
  <code>
<span class="key">java -jar app.jar --spring.profiles.active</span>=<span class="value">staging</span>
  </code>
</pre>
        </li>
        <li>Programmatically (before Spring context starts):
            <pre class="java-code">
  <code>
<span class="class">SpringApplication</span> <span class="var">app</span> = <span class="keyword">new</span> <span
          class="class">SpringApplication</span>(MyApp.class);
<span class="var">app</span>.setAdditionalProfiles(<span class="string">"local"</span>);
<span class="var">app</span>.run(<span class="var">args</span>);
  </code>
</pre>
        </li>
    </ol>
    <hr>
    <h2>3. Profile-Specific Property Files</h2>
    <p>Spring Boot automatically loads properties from files named:</p>
    <ul>
        <li>application-{profile}.properties</li>
        <li>application-{profile}.yml</li>
    </ul>
    <p>Example structure:</p>
    <pre class="code-block">
  <code>
<span class="comment"># src/main/resources/</span>
<span class="key">application.properties</span>    <span class="comment"># Common properties</span>
<span class="key">application-dev.properties</span>    <span class="comment"># Development</span>
<span class="key">application-prod.properties</span>    <span class="comment"># Production</span>
<span class="key">application-qa.properties</span>    <span class="comment"># QA</span>
  </code>
</pre>

    <p>Property precedence (later overrides earlier):</p>
    <ol>
        <li>application.properties</li>
        <li>application-[profile].properties</li>
        <li>OS environment variables</li>
        <li>Command line arguments</li>
    </ol>
    <hr>
    <h2>4. Advanced Profile Techniques</h2>
    <h4>Profile Groups (Spring Boot 2.4+)</h4>
    <p>Group related profiles together:</p>
    <pre class="code-block">
  <code>
<span class="key">spring.profiles.group.production</span>=<span class="value">prod,high-availability,audit</span>
<span class="key">spring.profiles.group.development</span>=<span class="value">dev,h2,debug</span>
  </code>
</pre>
    <p>Activate with:</p>
    <pre class="code-block">
  <code>
<span class="key">--spring.profiles.active</span>=<span class="value">production</span>
  </code>
</pre>

    <h4>Conditional Configuration with @Profile</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@Service</span>
<span class="annotation">@Profile</span>(<span class="string">"!prod"</span>) <span class="comment">// Active in all profiles EXCEPT prod</span>
<span class="keyword">public class</span> <span class="class">MockEmailService</span> <span
          class="keyword">implements</span> <span
          class="class">EmailService</span> {
    <span class="comment">// ...</span>
}

<span class="annotation">@Repository</span>
<span class="annotation">@Profile</span>({<span class="string">"prod"</span>, <span
          class="string">"staging"</span>}) <span
          class="comment">// Only in prod/staging</span>
<span class="keyword">public class</span> <span class="class">JpaOrderRepository</span> <span
          class="keyword">implements</span> <span
          class="class">OrderRepository</span> {
    <span class="comment">// ...</span>
}
  </code>
</pre>

    <h4>Programmatic Profile Checks</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@Autowired</span>
<span class="keyword">private</span> <span class="class">Environment</span> <span class="var">env</span>;

<span class="keyword">public</span> <span class="class">void</span> <span class="method">someMethod</span>() {
    <span class="keyword">if</span> (<span class="var">env</span>.acceptsProfiles(<span class="string">"dev"</span>)) {
        <span class="comment">// Dev-specific logic</span>
    }
}
  </code>
</pre>
    <hr>
    <h2>5. Testing with Profiles</h2>
    <h4>Test-Specific Profiles</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@SpringBootTest</span>
<span class="annotation">@ActiveProfiles</span>(<span class="string">"test"</span>)
<span class="keyword">public class</span> <span class="class">OrderServiceTests</span> {
    <span class="comment">// ...</span>
}
  </code>
</pre>

    <h4>Dynamic Profile Activation in Tests</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@Test</span>
<span class="keyword">public</span> <span class="class">void</span> <span
          class="method">testWithSpecificProfile</span>() {
    <span class="keyword">try</span> (<span class="class">ConfigurableApplicationContext</span> <span
          class="var">ctx</span> =
        <span class="keyword">new</span> <span class="class">SpringApplicationBuilder</span>(TestConfig.class)
            .profiles(<span class="string">"integration-test"</span>)
            .run()) {
        <span class="comment">// Test logic</span>
    }
}
  </code>
</pre>
    <hr>
    <h2>6. Common Profile Patterns</h2>
    <h4>Database Configurations</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@Configuration</span>
<span class="keyword">public class</span> <span class="class">DatabaseConfig</span> {
    <span class="annotation">@Bean</span>
    <span class="annotation">@Profile</span>(<span class="string">"dev"</span>)
    <span class="keyword">public</span> <span class="class">DataSource</span> <span
          class="method">h2DataSource</span>() {
        <span class="comment">// Embedded H2</span>
    }

    <span class="annotation">@Bean</span>
    <span class="annotation">@Profile</span>(<span class="string">"prod"</span>)
    <span class="keyword">public</span> <span class="class">DataSource</span> <span
          class="method">mysqlDataSource</span>() {
        <span class="comment">// Production MySQL</span>
    }
}
  </code>
</pre>

    <h4>Feature Flags</h4>
    <pre class="code-block">
  <code>
<span class="comment"># application-dev.properties</span>
<span class="key">feature.new-checkout.enabled</span>=<span class="value">true</span>
<span class="key">feature.legacy-reporting.enabled</span>=<span class="value">false</span>

<span class="comment"># application-prod.properties</span>
<span class="key">feature.new-checkout.enabled</span>=<span class="value">false</span>
<span class="key">feature.legacy-reporting.enabled</span>=<span class="value">true</span>
  </code>
</pre>
    <pre class="java-code">
  <code>
<span class="annotation">@Service</span>
<span class="keyword">public class</span> <span class="class">CheckoutService</span> {

    <span class="annotation">@Value</span>(<span class="string">"${feature.new-checkout.enabled:false}"</span>)
    <span class="keyword">private</span> <span class="class">boolean</span> <span
          class="var">newCheckoutEnabled</span>;

    <span class="keyword">public</span> <span class="class">void</span> <span
          class="method">processOrder</span>(<span class="class">Order</span> <span class="var">order</span>) {
        <span class="keyword">if</span> (<span class="var">newCheckoutEnabled</span>) {
            newCheckoutFlow(<span class="var">order</span>);
        } <span class="keyword">else</span> {
            legacyFlow(<span class="var">order</span>);
        }
    }
}
  </code>
</pre>

    <h4>Mock vs Real Services</h4>
    <pre class="java-code">
  <code>
<span class="annotation">@Profile</span>(<span class="string">"test | local"</span>)
<span class="annotation">@Service</span>
<span class="keyword">public class</span> <span class="class">MockPaymentGateway</span> <span
          class="keyword">implements</span> <span
          class="class">PaymentGateway</span> {
    <span class="comment">// Test implementation</span>
}

<span class="annotation">@Profile</span>(<span class="string">"prod | staging"</span>)
<span class="annotation">@Service</span>
<span class="keyword">public class</span> <span class="class">StripePaymentGateway</span> <span class="keyword">implements</span> <span
          class="class">PaymentGateway</span> {
    <span class="comment">// Real implementation</span>
}
  </code>
</pre>
    <hr>
    <div class="card-footer">
        <ul class="pagination justify-content-center">
            <li class="page-item"><a class="page-link btn-outline-primary"
                                     href="../sb/actuator.html">&lArr; Previous</a></li>
            <li class="page-item"><a class="page-link" href="../sb/logging.html">Next
                &rArr;</a></li>
        </ul>
    </div>

</main>

<!-- Scripts -->
<script src="../js/sidebar.js"></script>
<script src="../js/componentLoader.js"></script>
</body>
</html>